# å¤šçº¿ç¨‹

## åˆ›å»ºæ–°çº¿ç¨‹

1. å®ä¾‹åŒ–ä¸€ä¸ª `Thread` å¯¹è±¡, å†è°ƒç”¨å…¶ `start()` æ–¹æ³•. 

```java
public static void main(String[] args) {
    Thread thread = new Thread();
    thread.start();
}
```

ä½†æ˜¯è¿™ç§æ–¹å¼å¯åŠ¨çš„çº¿ç¨‹æ— æ³•åšä»»ä½•äº‹æƒ….

2.  ç»§æ‰¿ `Thread`, å®ç°ä¸€ä¸ªèƒ½åšäº‹çš„å­ç±»: 

```java
public class Multithreading {
    public static void main(String[] args) {
        Thread thread = new MyThread();
        thread.start();
    }
}

class MyThread extends Thread {
    @Override
    public void run() {
        System.out.println(MyThread.class.getSimpleName());
    }
}
```

**è¾“å‡º**: 
`MyThread`

3.  åˆ›å»º `Thread` å®ä¾‹æ—¶ä¼ å…¥ä¸€ä¸ª `Runnable` å®ä¾‹: 

```java
Thread thread1 = new Thread(new MyRunnable());
thread1.start();

class MyRunnable implements Runnable {
    @Override
    public void run() {
        System.out.println(MyRunnable.class.getSimpleName());
    }
}

```

**è¾“å‡º**:

`MyRunnable` 

æˆ–è€…ä½¿ç”¨ `lambda` è¯­æ³•å°†å…¶ç®€å†™ä¸º: 

```java
Thread lambdaThread = new Thread(() -> {
    System.out.println("lambdaThread");
});
lambdaThread.start();
```

**è¾“å‡º**: 

`lambdaThread` 

## å¤šçº¿ç¨‹è¿è¡Œ

å¯¹äºä»£ç : 

```java
public class Multithreading {
    public static void main(String[] args) {
        System.out.println("Main start...");
        Thread t = new Thread() {
            @Override
            public void run() {
                print("Thread", 100);
            }
        };
        t.start();
        print("ğŸ¤£ğŸ¤£ğŸ¤£", 100);
    }

    private static void print(String name, int limit) {
        for (int i = 0; i < limit; i++) {
            System.out.printf("%s running! \t", name);
            if ((i + 1) % 5 == 0) {
                System.out.println();
            }
        }
    }
}
```

**è¾“å‡º**: (æˆªå–ä¸€éƒ¨åˆ†)

>ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	
>ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	
>Thread running! 	Thread running! 	Thread running! 	Thread running! 	Thread running! 	
>Thread running! 	Thread running! 	Thread running! 	Thread running! 	Thread running! 	
>Thread running! 	Thread running! 	Thread running! 	Thread running! 	Thread running! 	
>Thread running! 	Thread running! 	Thread running! 	Thread running! 	Thread running! 	
>Thread running! 	Thread running! 	Thread running! 	Thread running! 	Thread running! 	
>Thread running! 	Thread running! 	Thread running! 	Thread running! 	Thread running! 	
>Thread running! 	Thread running! 	Thread running! 	Thread running! 	Thread running! 	
>Thread running! 	Thread running! 	Thread running! 	Thread running! 	Thread running! 	
>ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	
>ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running! 	ğŸ¤£ğŸ¤£ğŸ¤£ running!

å³çº¿ç¨‹ `t` ä¸ä¸»çº¿ç¨‹ `main` çš„è°ƒåº¦æ˜¯éšæœºçš„, ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦, ç¨‹åºæœ¬èº«æ— æ³•ç¡®å®šçº¿ç¨‹çš„è°ƒåº¦é¡ºåº. 

### çº¿ç¨‹çš„ä¼˜å…ˆçº§

`Thread.setPriority(int n)` æ–¹æ³•å¯ä»¥è®¾å®šçº¿ç¨‹çš„ä¼˜å…ˆçº§, å–å€¼èŒƒå›´: `[1, 10]`. 

## çº¿ç¨‹çš„çŠ¶æ€

ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åªèƒ½è°ƒç”¨ä¸€æ¬¡ `star()` æ–¹æ³•. åœ¨è°ƒç”¨ `start()` æ–¹æ³•åæ–°çº¿ç¨‹å¼€å§‹æ‰§è¡Œ `run()` æ–¹æ³•, ä¸”åœ¨ `run()` æ–¹æ³•æ‰§è¡Œå®Œæ¯•å**ç»“æŸè¿›ç¨‹**. 

å› æ­¤ Java çº¿ç¨‹çš„çŠ¶æ€æœ‰å¦‚ä¸‹å‡ ç§: 

-   `New`: æ–°åˆ›å»ºçš„çº¿ç¨‹, ä½†æœªæ‰§è¡Œ;
-   `Runnable`: è¿è¡Œä¸­çš„çº¿ç¨‹, æ­£åœ¨æ‰§è¡Œ `run()` æ–¹æ³•; 
-   `Blocked`: è¿è¡Œä¸­çš„çº¿ç¨‹, å› ä¸ºæŸäº›æ“ä½œè¢«é˜»å¡è€ŒæŒ‚èµ·; 
-   `Waiting`: è¿è¡Œä¸­çš„çº¿ç¨‹, å› ä¸ºæŸäº›æ“ä½œåœ¨ç­‰å¾…; 
-   `Timed Waiting`: è¿è¡Œä¸­çš„çº¿ç¨‹, å› ä¸ºæ‰§è¡Œ `sleep()` æ–¹æ³•è€Œæ­£åœ¨è®¡æ—¶ç­‰å¾…; 
-   `Terminated`: çº¿ç¨‹å·²ç»ˆæ­¢, å› ä¸º `run()` æ–¹æ³•æ‰§è¡Œå®Œæ¯•. 

**çŠ¶æ€è½¬ç§»å›¾:** 

```mermaid
flowchart TB
	subgraph New
	end
	subgraph Running[Running Threads]
		direction LR
		Runnable
		Blocked
		Waiting
		Timed[Timed Waiting]
	end
	New --> Running
	Running --> Terminated
```

å³å½“ä¸€ä¸ªçº¿ç¨‹å¯åŠ¨å, å®ƒä¼šåœ¨ `Runnable`ã€`Blocked`ã€`Waiting` å’Œ `Timed Waiting` è¿™å‡ ä¸ªçŠ¶æ€ä¸­åˆ‡æ¢, ç›´åˆ°å˜æˆ `Terminated` çŠ¶æ€. 

çº¿ç¨‹ç»ˆæ­¢çš„åŸå› : 

-   çº¿ç¨‹æ­£å¸¸ç»ˆæ­¢: `run()` æ–¹æ³•æ‰§è¡Œå®Œæ¯•; 
-   çº¿ç¨‹æ„å¤–ç»ˆæ­¢: `run()` æ–¹æ³•å› æœªæ•è·çš„å¼‚å¸¸è€Œå¯¼è‡´çº¿ç¨‹ç»ˆæ­¢; 
-   å¯¹æŸçº¿ç¨‹çš„ `Thread` å®ä¾‹è°ƒç”¨ `stop()` æ–¹æ³•è€Œå¼ºåˆ¶ç»ˆæ­¢ (ä¸å»ºè®®ä½¿ç”¨). 

### `join()` ç­‰å¾…çº¿ç¨‹ç»“æŸ

ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹ç»“æŸ. åœ¨ `main()` é‡Œå¯åŠ¨çº¿ç¨‹ `t` å, å¯ä»¥é€šè¿‡ `t.join()` ç­‰å¾… `t` çº¿ç¨‹ç»“æŸåå†è¿è¡Œ `main()`: 

>`t.join()` ä¼šå°† `main()` æŒ‚èµ·. 

```java
public class Multithreading {
    public static void main(String[] args) throws InterruptedException {
        Thread thread = new MyThread("ğŸ¤£ğŸ¤£ğŸ¤£");
        System.out.println("Start");
        thread.start();
        // å°† main() çº¿ç¨‹æŒ‚èµ·, ç­‰å¾… t çº¿ç¨‹ç»“æŸåæ‰ç»§ç»­æ‰§è¡Œ
        thread.join();
        Run.run("Main");
        System.out.println("End");
    }
}

class MyThread extends Thread {
    private static String name;

    public MyThread(String n) {
        name = n;
    }

    @Override
    public void run() {
        Run.run(name);
    }
}

class Run {
    public static void run(String name) {
        for (int i = 0; i < 100; i++) {
            System.out.printf("%s running~\t", name);
            if ((i + 1) % 5 == 0) {
                System.out.println();
            }
        }
    }
}
```

**è¾“å‡º**: (æˆªé€‰)

`main()` çº¿ç¨‹çš„è¾“å‡ºå…¨éƒ¨éƒ½åœ¨ `t` çš„è¾“å‡ºçš„åé¢. 

>ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	
>ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	
>ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	
>ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	
>ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	
>ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	
>Main running~	Main running~	Main running~	Main running~	Main running~	
>Main running~	Main running~	Main running~	Main running~	Main running~	
>Main running~	Main running~	Main running~	Main running~	Main running~	
>Main running~	Main running~	Main running~	Main running~	Main running~	
>Main running~	Main running~	Main running~	Main running~	Main running~	
>Main running~	Main running~	Main running~	Main running~	Main running~	

è‹¥å°† `t.join()` æ³¨é‡Šæ‰åçš„è¾“å‡º: (æˆªé€‰)

æ­¤æ—¶ `main()` å’Œ `t` çš„è¾“å‡ºå°±æ··åœ¨ä¸€èµ·äº†. 

>   Main running~	Main running~	Main running~	Main running~	Main running~	
>   Main running~	Main running~	Main running~	Main running~	Main running~	
>   Main running~	Main running~	Main running~	Main running~	Main running~	
>   Main running~	Main running~	Main running~	Main running~	Main running~	
>   ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	
>   ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	
>   ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	ğŸ¤£ğŸ¤£ğŸ¤£ running~	Main running~	Main running~	Main running~	Main running~	Main running~	
>   Main running~	Main running~	Main running~	Main running~	Main running~	

## ä¸­æ–­çº¿ç¨‹

è‹¥æŸçº¿ç¨‹åœ¨æ‰§è¡Œä»»åŠ¡æœŸé—´éœ€è¦è¢«ä¸­æ–­, é‚£ä¹ˆç”±**å…¶å®ƒçº¿ç¨‹**ç»™å®ƒå‘é€ä¸€ä¸ªä¿¡å·, è¯¥çº¿ç¨‹æ”¶åˆ°ä¿¡å·åç»“æŸæ‰§è¡Œ `run()` æ–¹æ³•ä¾¿ä½¿å¾—è‡ªèº«ç«‹åˆ»ç»“æŸè¿è¡Œ. 

å¦‚ä»ç½‘ç»œä¸‹è½½ 100MB çš„æ–‡ä»¶æ—¶, è‹¥ç”¨æˆ·å–æ¶ˆä¸‹è½½, å°±éœ€è¦ä¸­æ–­ä¸‹è½½çº¿ç¨‹çš„æ‰§è¡Œ. 

åœ¨å…¶å®ƒçº¿ç¨‹ä¸­å¯¹ç›®æ ‡çº¿ç¨‹æ‰§è¡Œ `interrupt()` æ–¹æ³•å³å¯å°†å…¶ä¸­æ–­. 
